{% extends "layout.html" %}

{% load static %}

{% block body %}
{% load humanize %}
<div class="container chatpage" style="background-color: white; width: 100%; height: 650px; padding: 30px;">
    
    <form action="{% url 'chat' %}" method="post">
        {% csrf_token %}
        <div class="form-group">
            <label for="exampleInputEmail1">Post Comment </label>
            <input type="text" class="form-control" name="comment" placeholder="Enter comment here">
        </div>    
        <input type="submit" value="Submit">
    </form>
    
    {% for post in posts %}
        <div class="row my-3">
            <div class="col-md-1 ">
                <img class="rounded mx-auto d-block w-100 p-2" src="{% static 'images/user2.png' %}"  alt="user">
            </div>
            <div class="col-md-11 "> 
                <b> mike </b> <span class="badge badge-secondary ">{{ post.date| naturaltime }}</span>
                <div>{{ post.message }}</div>
                <div class="reply mx-0">            
                    <button class="btn btn-sm btn-primary" onclick="reply()" id="reply{{post.id}}" type="button" data-toggle="collapse" data-target="#replyBox{{comment.sno}}" aria-expanded="false" aria-controls="replyBox{{comment.sno}}">
                        Reply
                    </button>
                    <div class="collapse" id="replyBox">
                        <div class="card card-body my-2">
                            <form action="{% url 'chat' %}" method="post">
                                {% csrf_token %}
                                <div class="form-group">
                                    <label for="comment">Post a reply </label>
                                    <input type="text" class="form-control" name="reply" placeholder="Enter comment here">
                                    <input type="hidden" name="parentSno" value="{{post.id}}">
                                </div>
                                <!-- <input type="hidden" name="postSno" value="{{post.id}}"> -->
                                <button type="submit" class="btn btn-primary">Submit</button>
                            </form>
                        </div>
                    </div>
        
                   
                </div>
            </div>
        </div>
    {% endfor %}
</div>
{% endblock %}

{% block script%}
{% comment %} var replybtn = document.getElementByClassName("btn");
replybtn.id
document.getElementById("myBtn").onclick = function() {myFunction()}; {% endcomment %}
function reply(){
    var replybox = document.getElementById('replyBox');
    console.log(replybox.className);
    if (replybox.className  == "collapse"){
        replybox.className  = 'uncollapse';
    }else if(replybox.className  == "uncollapse"){
        replybox.className  = 'collapse'
    } 
}
{% comment %} 
document.addEventListener("click", event => {
    const element = event.target;
    if (element.className  == "collapse"){
        element.className  = 'uncollapse';
    }else if(element.className  == "uncollapse"){
        element.className  = 'collapse'
    } 
}); {% endcomment %}

{% endblock %}